# ========================================
# LOCAL TEST ENVIRONMENT
# Media Center Arti Marziali - Test Locale
# ========================================
#
# Questo file è per TESTARE in locale prima di deployare.
# Usa solo servizi Docker (postgres, redis) - NO servizi esterni.
#
# Usage:
# 1. Copy questo file a .env.local
# 2. Modifica solo le variabili marcate [REQUIRED]
# 3. Lascia tutto il resto così com'è
# 4. docker-compose up -d
#
# ========================================

# ========================================
# APPLICATION SETTINGS
# ========================================
ENV=development
DEBUG=true
APP_NAME=Media Center Arti Marziali Local
APP_VERSION=1.0.0-local

# Domain (localhost)
DOMAIN=localhost
BACKEND_URL=http://localhost:8000
FRONTEND_URL=http://localhost:3000
ALLOWED_HOSTS=localhost,127.0.0.1

# CORS (permetti tutto in locale)
CORS_ORIGINS=http://localhost:3000,http://localhost:8000,http://127.0.0.1:3000

# ========================================
# SECURITY (valori test - NON per production!)
# ========================================
SECRET_KEY=local_test_secret_key_change_in_production_12345678901234567890

# JWT Configuration (più lunghi per test)
ACCESS_TOKEN_EXPIRE_MINUTES=1440  # 24 ore
REFRESH_TOKEN_EXPIRE_DAYS=30

# Password hashing
BCRYPT_ROUNDS=4  # Più veloce in test

# ========================================
# DATABASE - PostgreSQL (Docker)
# ========================================
# Usa il database del docker-compose
DATABASE_URL=postgresql://martial_user:martial_pass@localhost:5432/martial_arts_local

# Connection pool (più piccolo per locale)
DB_POOL_SIZE=5
DB_MAX_OVERFLOW=10
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# ========================================
# REDIS (Docker)
# ========================================
REDIS_URL=redis://localhost:6379/0
REDIS_PASSWORD=

# Cache TTL (più corti per vedere cambiamenti)
CACHE_TTL_DEFAULT=60
CACHE_TTL_USER_PROFILE=300
CACHE_TTL_VIDEO_METADATA=600
CACHE_TTL_SEARCH_RESULTS=180

# ========================================
# STRIPE (MODALITÀ TEST - optional)
# ========================================
# [OPTIONAL] Se vuoi testare pagamenti, usa le test keys di Stripe
# Altrimenti lascia vuoto - l'app funziona lo stesso
STRIPE_SECRET_KEY=sk_test_51234567890  # Lascia vuoto se non hai account Stripe
STRIPE_PUBLISHABLE_KEY=pk_test_51234567890
STRIPE_WEBHOOK_SECRET=whsec_test_123
STRIPE_WEBHOOK_ENDPOINT=http://localhost:8000/api/v1/webhooks/stripe

# ========================================
# FILE STORAGE (Local Filesystem)
# ========================================
# In locale salva i file su disco invece di S3
USE_LOCAL_STORAGE=true
LOCAL_STORAGE_PATH=./uploads
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_REGION=eu-west-1
S3_BUCKET_NAME=local-test-bucket
S3_PUBLIC_URL=http://localhost:8000/uploads

# Video limits
MAX_UPLOAD_SIZE_MB=100  # Più piccolo per test
ALLOWED_VIDEO_FORMATS=mp4,mov,avi,mkv

# ========================================
# EMAIL (MOCK - stampa in console)
# ========================================
# In locale non inviare email vere, stampa in console
EMAIL_PROVIDER=mock
SENDGRID_API_KEY=
EMAIL_FROM=test@localhost
EMAIL_FROM_NAME=Media Center Local Test

# Email URLs (localhost)
EMAIL_VERIFICATION_URL=http://localhost:3000/verify-email
PASSWORD_RESET_URL=http://localhost:3000/reset-password

# ========================================
# AI SERVICES (MOCK o OPTIONAL)
# ========================================
# [OPTIONAL] Se hai API keys OpenAI, usale. Altrimenti lascia vuoto.
OPENAI_API_KEY=  # Lascia vuoto per disabilitare AI
OPENAI_MODEL=gpt-3.5-turbo  # Più economico per test
OPENAI_MAX_TOKENS=500

ANTHROPIC_API_KEY=
ANTHROPIC_MODEL=claude-3-haiku-20240307

# Google Cloud (non necessario per test base)
GOOGLE_APPLICATION_CREDENTIALS=
GOOGLE_CLOUD_PROJECT=
TRANSLATION_PROVIDER=mock  # Usa mock invece di servizi reali
TRANSLATION_API_KEY=

# ========================================
# CELERY (Docker Redis)
# ========================================
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/2

# Celery workers (meno workers per locale)
CELERY_WORKER_CONCURRENCY=2
CELERY_TASK_TIME_LIMIT=1800
CELERY_TASK_SOFT_TIME_LIMIT=1500

# Video processing
VIDEO_PROCESSING_QUEUE=video_processing
SKELETON_EXTRACTION_QUEUE=skeleton_extraction
TRANSLATION_QUEUE=translation

# ========================================
# CDN (DISABLED in locale)
# ========================================
CDN_ENABLED=false
CDN_URL=http://localhost:8000
CLOUDFLARE_ZONE_ID=
CLOUDFLARE_API_KEY=

# ========================================
# MONITORING (DISABLED in locale)
# ========================================
# Sentry NON necessario per test locale
SENTRY_DSN=
SENTRY_ENVIRONMENT=local
SENTRY_TRACES_SAMPLE_RATE=0
SENTRY_PROFILES_SAMPLE_RATE=0

# Logging
LOG_LEVEL=DEBUG  # Più verboso in locale
LOG_FORMAT=text  # Più leggibile in console

# ========================================
# RATE LIMITING (DISABLED per test facili)
# ========================================
RATE_LIMIT_ENABLED=false  # Disabilita per testare liberamente
RATE_LIMIT_LOGIN=1000/minute
RATE_LIMIT_API=10000/minute
RATE_LIMIT_UPLOAD=1000/hour

# ========================================
# SECURITY HEADERS (RELAXED per localhost)
# ========================================
ENABLE_HTTPS_REDIRECT=false  # HTTP va bene in locale
ENABLE_HSTS=false
HSTS_MAX_AGE=0
ENABLE_CSP=false  # Più facile debuggare senza CSP
CSP_POLICY=""

# ========================================
# FEATURE FLAGS (TUTTO ABILITATO)
# ========================================
ENABLE_REGISTRATION=true
ENABLE_OAUTH=false  # OAuth richiede setup esterno
ENABLE_VIDEO_UPLOAD=true
ENABLE_LIVE_STREAMING=true
ENABLE_AI_COACH=true  # Funziona anche senza API keys (mock)
ENABLE_POSE_CORRECTION=true
ENABLE_BLOCKCHAIN=false
ENABLE_MAINTENANCE_MODE=false

# ========================================
# BUSINESS CONFIGURATION (valori test)
# ========================================
STELLINE_EUR_RATIO=100

# Subscription tiers (EUR cents) - prezzi test più bassi
SUBSCRIPTION_HYBRID_LIGHT_PRICE=100  # €1 invece di €4.99
SUBSCRIPTION_HYBRID_STANDARD_PRICE=200  # €2 invece di €9.99
SUBSCRIPTION_PREMIUM_PRICE=500  # €5 invece di €19.99
SUBSCRIPTION_BUSINESS_PRICE=1000  # €10 invece di €49.99

# PPV
PPV_MIN_PRICE=0.50  # Più basso per test
PPV_MAX_PRICE=10.00

# Revenue split
MAESTRO_REVENUE_SHARE=40
ASD_REVENUE_SHARE=50
PLATFORM_REVENUE_SHARE=10

# Withdrawal
WITHDRAWAL_MINIMUM_EUR=10  # Più basso per testare

# ========================================
# MOBILE APP (non necessario per backend test)
# ========================================
EXPO_PUBLIC_API_URL=http://localhost:8000
EXPO_PUBLIC_WS_URL=ws://localhost:8000
EXPO_PROJECT_ID=local-test
FIREBASE_SERVER_KEY=
FIREBASE_SENDER_ID=

# ========================================
# BACKUP (DISABLED in locale)
# ========================================
BACKUP_ENABLED=false
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=7
BACKUP_S3_BUCKET=

# ========================================
# DEV TOOLS (ABILITATI in locale)
# ========================================
ENABLE_SWAGGER_DOCS=true  # Utile per testare API
ENABLE_ADMIN_PANEL=true
ENABLE_DEBUG_TOOLBAR=true  # Utile per debug
ENABLE_PROFILER=true

# ========================================
# THIRD-PARTY (non necessari per test)
# ========================================
GA_TRACKING_ID=
FB_PIXEL_ID=
HOTJAR_ID=
INTERCOM_APP_ID=

# ========================================
# SSL (non necessario in locale)
# ========================================
SSL_CERT_PATH=
SSL_KEY_PATH=
LETSENCRYPT_EMAIL=

# ========================================
# DOCKER (per docker-compose locale)
# ========================================
COMPOSE_PROJECT_NAME=martial_arts_local
RESTART_POLICY=no  # Non restart automatico in locale

# Container resource limits (più bassi per locale)
BACKEND_MEMORY_LIMIT=512m
BACKEND_CPU_LIMIT=1
FRONTEND_MEMORY_LIMIT=512m
FRONTEND_CPU_LIMIT=1

# ========================================
# QUICK START - VALORI MINIMI RICHIESTI
# ========================================
#
# Per far partire il progetto in locale, serve SOLO:
#
# 1. SECRET_KEY (già configurato sopra ✅)
# 2. DATABASE_URL (già configurato per Docker ✅)
# 3. REDIS_URL (già configurato per Docker ✅)
#
# TUTTO IL RESTO è opzionale!
#
# Come usare:
# 1. docker-compose up -d postgres redis
# 2. docker-compose up -d backend
# 3. Apri http://localhost:8000/docs
#
# ========================================
